{
  "version": 3,
  "file": "index.js",
  "sourceRoot": "..",
  "sources": [
    "src\\index.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "ogid = (radix, rnd) ->\r\n  parseInt((new Date().valueOf() - new Date(2020,0,1).valueOf()).toString().concat(Math.floor(Math.random() * (9999999 or rnd))).split('').reverse().join('')).toString(radix or 36)\r\nhash = (str) ->\r\n  if typeof str is 'undefined'\r\n    return 0\r\n  h = 5381\r\n  i = str.length\r\n  while i\r\n    h = (h * 33) ^ str.charCodeAt --i\r\n  h\r\nhashObject = (obj) ->\r\n  hashed = {}\r\n  for key, val of obj\r\n    continue if /^\\$/.test key\r\n    hashed[key] = hash JSON.stringify(val)\r\n  hashed\r\nCallbacks = ->\r\n  callbacks = {}\r\n  toRemove = []\r\n  $on: (name, fn) ->\r\n    callbacks[name] = callbacks[name] or []\r\n    callbacks[name].push fn\r\n  $once: (name, fn) ->\r\n    callbacks[name] = callbacks[name] or []\r\n    onceFn = (data) ->\r\n      output = await fn data\r\n      toRemove.push onceFn\r\n      output\r\n    callbacks[name].push onceFn\r\n  $off: (name, fn) ->\r\n    callbacks[name] = callbacks[name] or []\r\n    callbacks[name].splice callbacks[name].indexOf(fn), 1\r\n  $call: (name, data) ->\r\n    if callbacks[name]\r\n      for fn in callbacks[name]\r\n        await fn data\r\n    for fn in toRemove\r\n      if callbacks[name]\r\n        callbacks[name].splice callbacks[name].indexOf(fn), 1\r\n        toRemove.splice toRemove.indexOf(fn), 1\r\nEnvironment = ->\r\n  #from headjs\r\n  ua = navigator.userAgent.toLowerCase()\r\n  mobile = /mobile|android|kindle|silk|midp|phone|(windows .+arm|touch)/.test(ua)\r\n  ua = /(chrome|firefox)[ \\/]([\\w.]+)/.exec(ua) or /(iphone|ipad|ipod)(?:.*version)?[ \\/]([\\w.]+)/.exec(ua) or /(android)(?:.*version)?[ \\/]([\\w.]+)/.exec(ua) or /(webkit|opera)(?:.*version)?[ \\/]([\\w.]+)/.exec(ua) or /(msie) ([\\w.]+)/.exec(ua) or /(trident).+rv:(\\w.)+/.exec(ua) or []\r\n  browser = ua[1]\r\n  switch browser\r\n    when 'msie', 'trident' then 'ie'\r\n    when 'ipod', 'ipad', 'iphone' then 'ios'\r\n    when 'webkit' then 'safari'\r\n  mobile: mobile\r\n  browser: browser\r\n  version: ua[2]\r\nYma = (appName) ->\r\n  rootElem = null\r\n  components = {}\r\n  elements = []\r\n  scopes = {}\r\n  services = {}\r\n  environment = Environment()\r\n  callbacks = Callbacks()\r\n  bootstrapped = false\r\n  makeId = (node, root) ->\r\n    root = root or rootElem\r\n    return 'root' if node is root\r\n    id = ''\r\n    while node and node isnt root\r\n      id += node.tagName + ':'\r\n      mynode = node\r\n      while mynode.previousSibling\r\n        id += mynode.tagName + '@'\r\n        mynode = mynode.previousSibling\r\n      node = node.parentNode\r\n    id\r\n  evalInContext = (str, context) ->\r\n    try\r\n      (new Function(\"with(this) {return #{str}}\"))\r\n      .call context\r\n  offset = (node) ->\r\n    nodeOffset =  x: 0, y: 0, w: node.offsetWidth, h: node.offsetHeight\r\n    while node.parentNode\r\n      nodeOffset.x += node.offsetLeft\r\n      nodeOffset.y += node.offsetTop\r\n      node = node.parentNode\r\n    nodeOffset\r\n  fillTemplate = (template, scope) ->\r\n    template.replace /\\{\\{(.+?)\\}\\}/g, (all, expression) ->\r\n      if typeof(result = evalInContext expression, scope) is 'undefined'\r\n        ''\r\n      else\r\n        result\r\n  mergeScopes = (scope, merge, protectedFields) ->\r\n    protectedFields = protectedFields or []\r\n    for key, val of merge\r\n      if not protectedFields.includes key\r\n        scope[key] = val\r\n  cleanupScopes = ->\r\n    for id, scope of scopes\r\n      scopeElems = elements.filter (element) -> element.scope is id\r\n      if scopeElems.length is 0\r\n        scope.$parent?.$children.splice scope.$parent?.$children.indexOf(id), 1\r\n        await scope.$call 'teardown'\r\n        #remove scope from any services\r\n        delete scopes[scope.$id]\r\n  teardown = (id) ->\r\n    r = new RegExp id + '$'\r\n    elements = elements.filter (element) ->\r\n      not r.test element.id\r\n    await cleanupScopes()\r\n  teardownChildren = (id) ->\r\n    r = new RegExp '.+' + id + '$'\r\n    elements = elements.filter (element) ->\r\n      not r.test element.id\r\n    await cleanupScopes()\r\n  findScopeElement = (element, scope) ->\r\n    if element.$scope.$id is scope.$id\r\n      return element\r\n    for child in element.$children\r\n      if myelement = findScopeElement child, scope\r\n        return myelement\r\n    null\r\n  checkForChanges = (element) ->\r\n    #render element html taking into account pre stuff\r\n    testRoot = document.createElement 'div'\r\n    testRoot.innerHTML = element.$html\r\n    for child in testRoot.children\r\n      return element if not child\r\n      for attr in child.getAttributeNames().map (name) -> name:name,value:child.getAttribute(name)\r\n        if attrComponent = components[attr.name.toUpperCase()]\r\n          element.$scope.$phase = 'prerender'\r\n          myscopes = attrComponent.pre element.$scope, child, getProps(child, element.$scope) if typeof(attrComponent.pre) is 'function'\r\n          if myscopes and typeof(myscopes) is 'object' and typeof(myscopes.length) isnt 'undefined'\r\n            #child.removeAttribute attr.name\r\n            i = myscopes.length\r\n            while i-- > 0\r\n              clone = child.cloneNode()\r\n              clone.innerHTML = child.innerHTML\r\n              child.parentNode.insertBefore clone, child.nextSibling\r\n            if child.children.length isnt element.$children.length\r\n              return element\r\n            child.parentNode.removeChild child\r\n    for child, i in testRoot.children\r\n      return element if child.innerHTML isnt element.$children[i]?.$html\r\n    null\r\n  updateScopes = (updatedScopes) ->\r\n    index = 0\r\n    while updatedScopes.length > index + 1\r\n      i = updatedScopes.length\r\n      while i-- > index\r\n        if updatedScopes[i]\r\n          if updatedScopes[i].$isDescendantOf updatedScopes[0]\r\n            updatedScopes.splice i, 1\r\n            continue\r\n          if updatedScopes[i].$isAncestorOf updatedScopes[0]\r\n            updatedScopes[0] = updatedScopes[i]\r\n            updatedScopes.splice i, 1\r\n            continue\r\n      index++\r\n    for updatedScope in updatedScopes\r\n      element = findScopeElement rootElem, updatedScope#could there be more than one?\r\n      changes = checkForChanges element\r\n      if changes\r\n        doTeardown = (element, skip) ->\r\n          element.$scope.$call('teardown') if not skip\r\n          doTeardown for child in element.$children\r\n          null\r\n        doTeardown changes, true\r\n        changes.$children = []\r\n        changes.$node.innerHTML = changes.$html\r\n        children = []\r\n        children.push child for child in changes.$node.children\r\n        render child, changes for child in children\r\n      #get root element for this scope\r\n      #try prebuilding this element\r\n      #if there are structural changes then fully rerender element\r\n      #reset vars for this element\r\n      resetElement = (element) ->\r\n        t = 0\r\n        for node in element.$node.childNodes\r\n          if node.nodeType is document.TEXT_NODE\r\n            node.replaceWith element.$textNodes[t++] or ''\r\n        for attr in element.$attributes\r\n          element.$node.setAttribute attr.name, attr.value if element.$node.hasAttributes attr.name\r\n        resetElement child for child in element.$children\r\n      resetElement element\r\n      fillVars element\r\n      checkAttrs element\r\n      callbacks.$call 'updated'\r\n    return\r\n  scopeVar = (op, path, value, scope) ->\r\n    myvar = evalInContext path, scope\r\n    arr = []\r\n    splitPoints = []\r\n    inside = null\r\n    lookingFor = null\r\n    level = 0\r\n    for letter, i in path.split ''\r\n      if inside\r\n        if letter is lookingFor\r\n          level--\r\n          if level is 0\r\n            Object.assign splitPoints[splitPoints.length-1],\r\n              endIndex: i\r\n              endPath: path.substr 0, i + 1\r\n            inside = null\r\n            lookingFor = null\r\n        else if letter is inside\r\n          level++\r\n      else\r\n        if letter is '['\r\n          level++\r\n          inside = '['\r\n          lookingFor = ']'\r\n          splitPoints.push\r\n            type: inside + lookingFor\r\n            index: i\r\n            path: path.substr 0, i\r\n        else if letter is '('\r\n          level++\r\n          inside = '('\r\n          lookingFor = ')'\r\n          splitPoints.push\r\n            type: inside + lookingFor\r\n            index: i\r\n            path: path.substr 0, i\r\n        else if letter is '.'\r\n          splitPoints.push\r\n            type: 'object'\r\n            index: i\r\n            path: path.substr 0, i\r\n    myvar = null\r\n    for sp in splitPoints\r\n      if sp.type is 'object'\r\n        myvar = evalInContext sp.path, scope\r\n        if typeof(myvar) is 'undefined'\r\n          myvar = evalInContext 'this.' + sp.path + '={}', scope\r\n      if sp.type is '[]'\r\n        myvar = evalInContext sp.path, scope\r\n        if typeof(myvar) is 'undefined'\r\n          myvar = evalInContext 'this.' + sp.path + '=[]', scope\r\n          myvar = evalInContext sp.endPath + '={}', scope\r\n    return (splitPoints[0]?.path or path) if op is 'rootName'\r\n    return evalInContext((splitPoints[0]?.path or path), scope) if op is 'root'\r\n    lastPoint = splitPoints[splitPoints.length - 1]\r\n    lastIndex = if lastPoint then (lastPoint.lastIndex or lastPoint.index) + 1 else 0\r\n    if splitPoints[splitPoints.length - 1]?.type is '[]'\r\n      field = evalInContext(path.substr(lastIndex).replace(/\\]$/, ''), scope)\r\n    else\r\n      if lastIndex\r\n        field = path.substr(lastIndex)\r\n      else\r\n        field = path\r\n    if op is 'get'\r\n      return (myvar or scope)[field]\r\n    else\r\n      (myvar or scope)[field] = value\r\n    value\r\n  setScopeVar = (path, value, scope) ->\r\n    scopeVar 'set', path, value, scope\r\n  getScopeVar = (path, scope) ->\r\n    scopeVar 'get', path, null, scope\r\n  getScopeVarRoot = (path, scope) ->\r\n    scopeVar 'root', path, null, scope\r\n  Scope = (parentScope) ->\r\n    scopeCallbacks = Callbacks()\r\n    timeouts = []\r\n    intervals = []\r\n    newscope =\r\n      $id: ogid()\r\n      $children: []\r\n      $parent: null\r\n      $environment: environment\r\n      $update: (updates, hard) ->\r\n        propagateForwards = (myscope, rootName, value) ->\r\n          propagate = (childScope) ->\r\n            childScope[rootName] = val\r\n            propagate child for child in childScope.$children\r\n            null\r\n          propagate myscope\r\n        for key, val of updates\r\n          rootName = scopeVar 'rootName', key, null, @\r\n          setScopeVar key, val, @\r\n          val = @[rootName]\r\n          myscope = @\r\n          while myscope and myscope.$parent\r\n            if myscope.$hash[rootName] and myscope.$hash[rootName] isnt myscope.$parent.$hash[rootName]\r\n              myscope[rootName] = val\r\n              propagateForwards myscope, rootName, val\r\n              break\r\n            myscope = myscope.$parent\r\n        updatedScopes = Object.values(scopes).filter (scope) -> (JSON.stringify(scope.$hash) isnt JSON.stringify(hashObject scope))\r\n        scope.$hash = hashObject scope for scope in updatedScopes\r\n        await updateScopes updatedScopes\r\n        callbacks.$call 'updated'\r\n      $use: (name) ->\r\n        if service = services[name]\r\n          @[name] = service.fn\r\n          service.scopes.push @\r\n        else if component = components[name.toUpperCase()]\r\n          services[name] =\r\n            fn: (component.service or component)()\r\n            scopes: [@]\r\n          @[name] = services[name].fn\r\n        @.$on 'teardown', ->\r\n          services[name].scopes.splice services[name].scopes.indexOf(@), 1\r\n      $on: scopeCallbacks.$on\r\n      $once: scopeCallbacks.$once\r\n      $off: scopeCallbacks.$off\r\n      $call: scopeCallbacks.$call\r\n      $callChildren: (name, data) ->\r\n        await scopeCallbacks.$call name, data\r\n        for childScope in @.$children\r\n          await childScope.$callChildren name, data if childScope #check this\r\n        null\r\n      $isDescendantOf: (scope) ->\r\n        return false if scope.$id is @.$id\r\n        myscope = @\r\n        while myscope.$parent\r\n          return true if myscope.$id is scope.$id\r\n          myscope = myscope.$parent\r\n        false\r\n      $isAncestorOf: (scope) ->\r\n        return false if scope.$id is @.$id\r\n        check = (myscope) ->\r\n          return true if myscope.$id is scope.$id\r\n          for childScope in myscope.$children\r\n            return true if check childScope\r\n          false\r\n        check scope\r\n      $offset: offset\r\n      $timeout: (fn, delay) ->\r\n        if timeouts.length is 0\r\n          scopeCallbacks.$on 'teardown', ->\r\n            for timeout in timeouts\r\n              window.clearTimeout timeout\r\n        timeouts.push window.setTimeout fn, delay\r\n      $interval: (fn, delay) ->\r\n        if intervals.length is 0\r\n          scopeCallbacks.$on 'teardown', ->\r\n            for interval in intervals\r\n              window.clearTimeout interval\r\n        intervals.push window.setInterval fn, delay\r\n      $addEventListeners: (elem, listeners, fn) ->\r\n        if typeof(listeners) is 'string'\r\n          listeners = [listeners]\r\n        for listener in listeners\r\n          elem.addEventListener listener, fn\r\n        @.$on 'teardown', ->\r\n          for listener in listeners\r\n            elem.removeEventListener listener, fn\r\n    if parentScope and parentScope.$id\r\n      parentScope.$children.push newscope\r\n      newscope.$parent = parentScope\r\n    mergeScopes newscope, parentScope, Object.keys(newscope)\r\n    scopes[newscope.$id] = newscope\r\n    newscope.$hash = hashObject newscope\r\n    newscope\r\n\r\n  getElement = (elem) ->\r\n    id = makeId elem\r\n    elements.filter((element) -> element.id is id)[0]\r\n  getProps = (elem, scope) ->\r\n    myattrs = {}\r\n    elem.getAttributeNames().forEach (name) -> myattrs[name] = if scope then fillTemplate(elem.getAttribute(name), scope) else elem.getAttribute(name)\r\n    myattrs\r\n  renderChildren = (node, parent) ->\r\n    #return if /\\byma-router-parked\\b/.test elem.className\r\n    children = []\r\n    children.push child for child in node.children\r\n    render child, parent for child in children\r\n  render = (node, parent, scope) ->\r\n    return if not node\r\n    return if /SCRIPT|STYLE/.test node.tagName\r\n    element =\r\n      $node: node\r\n      $parent: parent\r\n      $children: []\r\n      $scope: scope or parent?.$scope or Scope()\r\n      $html: node.innerHTML\r\n      $textNodes: Array.from(node.childNodes)?.filter (child) -> child.nodeType is document.TEXT_NODE\r\n      $attributes: node.getAttributeNames()?.map (name) ->\r\n        name: name\r\n        value: node.getAttribute name\r\n      $render: true\r\n    for attr in element.$attributes\r\n      if attrComponent = components[attr.name.toUpperCase()]\r\n        myscopes = attrComponent.pre element.$scope, node, getProps(node, element.$scope) if typeof(attrComponent.pre) is 'function'\r\n        if myscopes and typeof(myscopes) is 'object' and typeof(myscopes.length) isnt 'undefined'\r\n          node.removeAttribute attr.name\r\n          i = myscopes.length\r\n          while i-- > 0\r\n            clone = node.cloneNode()\r\n            clone.innerHTML = node.innerHTML\r\n            node.parentNode.insertBefore clone, node.nextSibling\r\n            render clone, element, myscopes[i]\r\n          node.parentNode.removeChild node\r\n          return if myscopes.length is 0\r\n        node.setAttribute 'checkattrs', true\r\n    if component = components[node.tagName.toUpperCase()]\r\n      element.$scope = Scope element.$scope\r\n      component.controller element.$scope, node, getProps(node, element.$scope.$parent) if component.controller\r\n      element.$scope.$hash = hashObject element.$scope\r\n      node.innerHTML = if component.template then component.template else element.$html\r\n      node.innerHTML = node.innerHTML.replace '<children></children>', element.$html\r\n      element.$html = node.innerHTML\r\n      #element.$html = node.innerHTML\r\n    else\r\n      node.innerHTML = element.$html\r\n      #html = elem.innerHTML\r\n    if parent then parent.$children.push element\r\n    renderChildren node, element\r\n    element\r\n  preRenderChildren = (elem, root, preElements) ->\r\n    #return if /\\byma-router-parked\\b/.test elem.className\r\n    children = []\r\n    children.push child for child in elem.children\r\n    await preRender child, root, 0, preElements for child in children\r\n  preRender = (elem, root, index, preElements, hash) ->\r\n    return if not elem\r\n    id = makeId elem, root\r\n    preId = 'PREX:' + id\r\n    html = elem.innerHTML\r\n    attributes = {}\r\n    #get scope using id\r\n    realElem = elements.filter((myelem) -> (myelem.id is id) or (myelem.id is preId))[index]\r\n    scope = scopes[realElem?.scope]\r\n    scope?.$phase = 'prerender'\r\n    if not (realElem or scope) or (scope and hash and scope.$dataHash and scope.$dataHash isnt hash)\r\n      preElements.push\r\n        id: 'UNKNOWN@' + id\r\n      return\r\n    #get .pre scopes\r\n    for attr in elem.getAttributeNames()\r\n      attributes[attr] = elem.getAttribute attr\r\n      if attrComponent = components[attr.toUpperCase()]\r\n        myscopes = await attrComponent.pre scope, elem, getProps(elem) if typeof(attrComponent.pre) is 'function'\r\n        if typeof(myscopes) isnt 'undefined'\r\n          if myscopes\r\n            if myscopes.length\r\n              i = myscopes.length\r\n              while i-- > 0\r\n                myscopes[i].$parent.$children.splice myscopes[i].$parent.$children.indexOf myscopes[i], 1\r\n                clone = elem.cloneNode()\r\n                clone.innerHTML = elem.innerHTML\r\n                clone.removeAttribute attr\r\n                elem.parentNode.insertBefore clone, elem.nextSibling\r\n                await preRender clone, root, i, preElements, myscopes[i].$dataHash\r\n              elem.parentNode.removeChild elem\r\n            else\r\n              if myscopes.length is 0\r\n                preElements.push\r\n                  id: 'UNKNOWN@H1:H1@' + makeId(elem.parentNode, root)\r\n                elem.parentNode.removeChild elem\r\n                return\r\n    #  preRender pre stuff\r\n    #get component\r\n    if component = components[elem.tagName]\r\n      elem.innerHTML = if component.template then component.template else html\r\n      elem.innerHTML = elem.innerHTML.replace '<children></children>', html\r\n    #render component\r\n    #push to preElements\r\n    preElements.push\r\n      id: id\r\n    #preRenderChildren\r\n    await preRenderChildren elem, root, preElements\r\n  fillVars = (element) ->\r\n    for attr in element.$attributes\r\n      if /\\{\\{/.test attr.value\r\n        element.$node.setAttribute attr.name, fillTemplate(attr.value, element.$scope)\r\n    for node in element.$node.childNodes\r\n      if node.nodeType is document.TEXT_NODE and /\\{\\{/.test node.data\r\n        node.replaceWith fillTemplate node.data, element.$scope\r\n    fillVars child for child in element.$children\r\n  checkAttrs = (element) ->\r\n    if element.$node.getAttribute 'checkattrs'\r\n      element.$node.removeAttribute 'checkattrs'\r\n      for attr in element.$attributes\r\n        if attrComponent = components[attr.name.toUpperCase()]\r\n          attrFn = attrComponent.post or attrComponent\r\n          attrFn element.$scope, element.$node, getProps(element.$node, element.$scope) if typeof(attrFn) is 'function'\r\n          element.$node.removeAttribute attr.name\r\n    checkAttrs child for child in element.$children\r\n\r\n  getService = (name) ->\r\n    if service = services[name]\r\n      return service\r\n    else if component = components[name.toUpperCase()]\r\n      services[name] =\r\n        fn: (component.service or component)()\r\n        scopes: []\r\n      return services[name]\r\n    null\r\n\r\n  appName: appName\r\n  render: (elem, scope) ->\r\n    if not bootstrapped\r\n      await callbacks.$call 'bootstrap'\r\n      bootstrapped = true\r\n    elem = elem or document.querySelector('[app=' + appName + ']')\r\n    rootElem = render elem\r\n    fillVars(rootElem)\r\n    checkAttrs(rootElem)\r\n    callbacks.$call 'rendered'\r\n    @\r\n  $renderChildren: (elem, scope) ->\r\n    await renderChildren elem, scope\r\n    await fillVars()\r\n    await checkAttrs()\r\n    callbacks.$call 'renderedChildren'\r\n  component: (nameOrObj, fn) ->\r\n    if typeof(nameOrObj) is 'object'\r\n      for name, fn of nameOrObj\r\n        components[name.toUpperCase()] = fn @\r\n        @.$appendStyles components[name.toUpperCase()].styles\r\n    else\r\n      components[nameOrObj.toUpperCase()] = fn @\r\n      @.$appendStyles components[nameOrObj.toUpperCase()].styles\r\n    @\r\n  Scope: Scope\r\n  Callbacks: Callbacks\r\n  $version: require('../package.json').version\r\n  $getComponents: ->\r\n    components\r\n  $getElements: ->\r\n    rootElem\r\n  $getServices: ->\r\n    services\r\n  $getScopes: ->\r\n    scopes\r\n  $eval: evalInContext\r\n  $offset: offset\r\n  $setScopeVar: setScopeVar\r\n  $getScopeVar: getScopeVar\r\n  $getElement: getElement\r\n  $getProps: getProps\r\n  $teardown: teardown\r\n  $teardownChildren: teardownChildren\r\n  $on: callbacks.$on\r\n  $once: callbacks.$once\r\n  $off: callbacks.$off\r\n  $hash: hash\r\n  $hashObject: hashObject\r\n  $makeId: makeId\r\n  $addClass: (elem, classNames) ->\r\n    classNames = [classNames] if typeof(classNames) is 'string'\r\n    for className in classNames\r\n      @.$removeClass elem, className\r\n      elem.className += ' ' + className\r\n    null\r\n  $removeClass: (elem, classNames) ->\r\n    classNames = [classNames] if typeof(classNames) is 'string'\r\n    for className in classNames\r\n      r = new RegExp '\\\\s*\\\\b' + className + '\\\\b', 'g'\r\n      elem.className = elem.className.replace r, ''\r\n    null\r\n  $update: (serviceName) ->\r\n    if service = getService serviceName\r\n      updateScopes service.scopes\r\n  $appendStyles: (stylesText) ->\r\n    return if not stylesText\r\n    styles = document.createElement 'style'\r\n    styles.innerText = stylesText.replace(/\\n/gi,'')\r\n    document.querySelector 'head'\r\n    .append styles\r\n  $internal:\r\n    components: components\r\n    scopes: scopes\r\n    services: services\r\n    callbacks: callbacks\r\n    fillTemplate: fillTemplate\r\n    mergeScopes: mergeScopes\r\n    cleanupScopes: cleanupScopes\r\n    updateScopes: updateScopes\r\n    scopeVar: scopeVar\r\n    getScopeVarRoot: getScopeVarRoot\r\n    getService: getService\r\nmodule.exports = Yma\r\n"
  ]
}